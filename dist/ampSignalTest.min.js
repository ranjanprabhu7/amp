(() => {
  var d = "https://beta.a.zzazz.com/event";
  function u() {
    return {
      width: window.innerWidth || document.documentElement.clientWidth,
      height: window.innerHeight || document.documentElement.clientHeight,
    };
  }
  async function h({ url: e }) {
    let n = u(),
      t = localStorage.getItem("user_id") || "",
      i = { url: e, device: n, type: "pageview" };
    try {
      let r = await (
        await fetch(d, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            ...(t && { "user-id": t }),
          },
          body: JSON.stringify(i),
        })
      ).json();
      localStorage.setItem("user_id", r.user_id),
        localStorage.setItem("event_id", r.event_id);
    } catch (o) {
      console.error("Pageview error:", o);
    }
  }
  async function m() {
    let e = localStorage.getItem("user_id") || "TEST_ID",
      t = { type: "poll", id: localStorage.getItem("event_id") || "TEST_ID" };
    try {
      await fetch(d, {
        method: "POST",
        headers: { "Content-Type": "application/json", "user-id": e },
        body: JSON.stringify(t),
      });
    } catch (i) {
      console.error("Poll error:", i);
    }
  }
  async function g({ price: e, currency: n }) {
    let t = localStorage.getItem("user_id") || "TEST_ID",
      o = {
        type: "price",
        id: localStorage.getItem("event_id") || "TEST_ID",
        price: e,
        currency: n,
      };
    try {
      await fetch(d, {
        method: "POST",
        headers: { "Content-Type": "application/json", "user-id": t },
        body: JSON.stringify(o),
      });
    } catch (r) {
      console.error("Price event error:", r);
    }
  }
  var l = null,
    p = !1,
    y = !1,
    f = () => {
      let e = document.getElementById("zzazz-signal-div"),
        n = e.getAttribute("data-url"),
        t = document.getElementById("zzazz-price"),
        i = document.getElementById("zzazz-trend-up"),
        o = document.getElementById("zzazz-trend-down"),
        r = JSON.stringify({ urls: [n], currency: "inr" });
      fetch("https://v.zzazz.com/v2/price", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: r,
      })
        .then((c) => c.json())
        .then((c) => {
          let s = c[n];
          if (!s || s.price === void 0) return;
          let a = s.price.toFixed(2);
          y || (e.classList.remove("hidden"), (y = !0)),
            p || (g({ price: s.price, currency: "inr" }), (p = !0)),
            (t.firstChild.textContent = a + " "),
            l !== null &&
              (a > l
                ? ((i.style.display = "flex"), (o.style.display = "none"))
                : a < l &&
                  ((o.style.display = "flex"), (i.style.display = "none"))),
            (l = a);
        })
        .catch((c) => console.error("Price fetch error:", c));
    };
  setInterval(f, 2e3);
  h({ url: window.location.origin });
  setInterval(m, 1e4);
})();
