(()=>{var h="https://a.zzazz.com/event",u="https://v.zzazz.com/v2/price",r="",c="";function p(){return{width:window.innerWidth||document.documentElement.clientWidth||0,height:window.innerHeight||document.documentElement.clientHeight||0}}async function d(n,t=!0){let e={"Content-Type":"application/json"};t&&r&&(e["user-id"]=r);try{return await(await fetch(h,{method:"POST",headers:e,body:JSON.stringify(n)})).json()}catch(i){return console.error(`Event error (${n.type}):`,i),null}}async function y({url:n}){let t={type:"pageview",url:n,device:p()},e=await d(t);e&&(r=e.user_id,c=e.event_id)}async function f(){!c||!r||await d({type:"poll",id:c})}async function v({price:n,currency:t}){await d({type:"price",id:c,price:n,currency:t})}var a=class{constructor(){this.lastPrice=null,this.eventSent=!1,this.visible=!1,this.signalDiv=document.getElementById("zzazz-signal-div"),this.priceEl=document.getElementById("zzazz-price"),this.trendUpEl=document.getElementById("zzazz-trend-up"),this.trendDownEl=document.getElementById("zzazz-trend-down")}show(){this.visible||(this.signalDiv.classList.remove("hidden"),this.visible=!0)}updateTrend(t){if(this.lastPrice===null)return;let e=t>this.lastPrice,i=t<this.lastPrice;this.trendUpEl.style.display=e?"flex":"none",this.trendDownEl.style.display=i?"flex":"none"}async fetchAndUpdate(){let t=this.signalDiv.getAttribute("data-url"),e=JSON.stringify({urls:[t],currency:"inr"});try{let s=(await(await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:e})).json())[t];if(!s||s.price===void 0)return;let o=s.price.toFixed(2);this.eventSent||(await v({price:s.price,currency:"inr"}),this.eventSent=!0),this.priceEl.firstChild.textContent=o+" ",this.updateTrend(o),this.lastPrice=o,this.show()}catch(i){console.error("Price fetch error:",i)}}},l=new a;(async()=>(await y({url:window.location.origin||document.location.origin||""}),setInterval(f,5e3),l.fetchAndUpdate(),setInterval(()=>l.fetchAndUpdate(),3e3)))();})();
