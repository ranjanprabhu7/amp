(()=>{(async function(){let a=document.getElementById("zzazz-signal-div"),m=a?.getAttribute("data-zzazz-t-id"),P="https://a.zzazz.com/event",N="https://cdn.zzazz.com/widget-rules/0999894d-399f-4e1f-ac8e-25861d437ce8.json",I="https://beta.v.zzazz.com/v3/price",o={user_id:null,event_id:null},s=[],d=!1,u=!1,l=null,f=!1,y=null,z=null,v=null,g=!1,p=()=>({width:window?.innerWidth||document?.documentElement?.clientWidth||0,height:window?.innerHeight||document?.documentElement?.clientHeight||0}),h=()=>({width:window?.screen?.width||0,height:window?.screen?.height||0}),k=({user_id:e,event_id:t})=>{e&&!o.user_id&&(o.user_id=e),t&&!o.event_id&&(o.event_id=t,d=!0,b())};function E(e,t){let n;return function(...i){clearTimeout(n),n=setTimeout(()=>{e.apply(this,i)},t)}}let B=E(()=>{U()},500),_=E(e=>{C(e)},500);window?.addEventListener("scroll",B),window?.addEventListener("click",_);async function c(e,t={}){let n={type:e,...t,id:o.event_id,pageId:o.event_id},i={Accept:"application/json","Content-Type":"application/json","tracking-id":`${m}`,...o.user_id&&{"user-id":o.user_id}};try{let r=await fetch(P,{method:"POST",credentials:"include",headers:i,body:JSON.stringify(n)}),w=await r.json().catch(()=>null);return{ok:r.ok,data:w}}catch(r){return console.error(`Failed to send event ${e}:`,r),{ok:!1,data:null}}}function L(e,t={}){s.push({type:e,payload:t}),b()}async function b(){if(!(!d||u)){for(u=!0;s.length;){let{type:e,payload:t}=s.shift();await c(e,t)}u=!1}}async function D(e){clearTimeout(y),z=e,g=!1,v=new Date().getTime();let t={browser:p(),device:h(),url:e,referrer:document.referrer},{ok:n,data:i}=await c("pageview",t);n&&i&&k(i),T(e)}async function T(e){if(e===z){let t=new Date().getTime()-v>6e5?6e4:5e3;try{await c("poll")}catch(n){console.error(n)}finally{y=setTimeout(()=>T(e),t)}}}async function O(e){if(!g){if(!d)return L("price",e);try{await c("price",e),g=!0}catch(t){console.log(t)}}}async function U(){try{let e={scrollPosition:window?.scrollY||0,browser:p(),device:h()};await c("scroll",e)}catch(e){console.log(e)}}function j(e){if(!e)return null;if(e.tagName==="A"&&e.href)return e.href;if(e.tagName==="BUTTON"&&e.formAction)return e.formAction;if(e.tagName==="BUTTON"&&e.getAttribute("data-url"))return e.getAttribute("data-url");let t=e.parentNode;for(;t;){let n=t.tagName;if(n==="A"&&t.href)return t.href;if(n==="BUTTON"&&t.formAction)return t.formAction;if(n==="BUTTON"&&t.getAttribute("data-url"))return t.getAttribute("data-url");t=t.parentNode}return null}async function C(e){try{let t=e?.target,n={browser:p(),device:h(),element:{tag:t?.tagName?.toLowerCase()||null,url:j(t)||null,position:{x:e?.pageX||0,y:e?.pageY||0}}};await c("click",n)}catch(t){console.log(t)}}async function S(){console.log("trackingId",m);try{return(await(await fetch(`${N}?dt=${Date.now()}`)).json()).showWidget===!0}catch(e){return console.error("Enable API error:",e),!1}}async function A(){let e=a?.getAttribute("data-url");if(e)try{let i=(await(await fetch(`${I}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:[e],currency:"inr"})})).json())[e];if(!i||isNaN(i.qap)){a.classList.add("hidden"),f=!1;return}let r=i.qap.toFixed(2);O({url:e,qap:i.qap,price:i.price,currency:"inr"});let w=document.getElementById("zzazz-price"),$=document.getElementById("zzazz-trend-up"),q=document.getElementById("zzazz-trend-down");w.firstChild.textContent=`${r} `,f||(a.classList.remove("hidden"),f=!0),l!==null&&($.style.display=r>=l?"flex":"none",q.style.display=r<l?"flex":"none"),l=r}catch(t){console.error("Price fetch error:",t),a.classList.add("hidden")}}if(!await S()){console.warn("Price pill disabled remotely."),a?.classList.add("hidden");return}console.log("Price pill enabled by remote rules."),D(window?.location?.origin||document?.location?.origin||""),A(),setInterval(A,3e3)})();})();
